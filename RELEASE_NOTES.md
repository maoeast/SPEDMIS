# 版本 1.0.0 发布说明

## 发布概览

**发布日期**: 2024-12-16  
**应用版本**: 1.0.0  
**应用名称**: 特殊教育多模态干预系统  
**构建目标**: Windows x64 (NSIS 安装程序)

---

## 新增功能和改进

### ✨ 安全增强（P0 级别修复）

#### 1. SECRET_KEY 环境变量化
- **改进**: 密钥不再硬编码在源代码中
- **方案**: 通过环境变量或 .env 文件动态加载
- **好处**: 支持密钥轮换，增强安全性
- **迁移**: 无缝，现有激活码继续有效

#### 2. 机器码算法升级
- **改进**: MD5 → SHA-256
- **安全性**: 从 128 位升级到 256 位
- **兼容性**: 支持旧 MD5 激活码（双验证模式）
- **迁移**: 现有用户无需重激活，新激活使用 SHA-256

#### 3. 激活信息加密存储
- **改进**: 从明文 → AES-256-GCM 加密
- **保护**: 机器码、激活码、硬件信息均已加密
- **检测**: 提供数据篡改检测（认证加密）
- **迁移**: 自动转换旧数据格式

#### 4. 虚拟机环境检测
- **新增**: 多层虚拟机检测机制
- **方法**: Windows 注册表检查、系统信息扫描、硬件特征分析
- **防护**: 防止应用在虚拟机中被无限复制
- **日志**: 详细的检测指标和置信度记录

### 🎨 UI/UX 优化

#### 1. 产品信息个性化
- **新增**: 英文产品名称显示和编辑
- **新增**: 版权信息（如©2013-2025）显示和编辑
- **位置**: 首页副标题和页脚均显示

#### 2. 返回按钮样式统一
- **改进**: 所有页面返回按钮样式一致
- **覆盖**: 高级设置、使用统计、模块页面
- **效果**: 改进用户体验，视觉更加统一

#### 3. 模块页面简化
- **移除**: 模块二级页面右上角的设置按钮
- **简化**: 页面布局更加清洁
- **整合**: 设置功能统一到高级设置页面

### 🔧 功能完善

#### 1. 应用图标映射修复
- **修复**: 418 个应用的图标显示
- **问题**: 原 APP020.png 映射有拼写错误（'gj cj.png'）
- **结果**: 所有应用现在显示正确的分类图标
- **验证**: 已通过完整的图标测试

#### 2. IPC 通信优化
- **修复**: 移除主进程中的重复 IPC 处理器
- **问题**: getModuleCategories 处理器定义了两次
- **结果**: 模块加载更稳定，无重复事件触发
- **验证**: Electron API 正确暴露到渲染进程

#### 3. 使用统计系统完整
- **功能**: 应用使用时长追踪和统计分析
- **数据**: SQLite 数据库存储，自动加密保护
- **展示**: 图表、表格、导出等完整分析功能
- **存储**: %APPDATA%\特殊教育多模态干预系统\data\usage-stats.db

---

## 技术规格

### 系统要求

- **操作系统**: Windows 7 SP1 或更高版本
- **处理器**: 1 GHz 或更快
- **内存**: 512 MB RAM（建议 1 GB）
- **磁盘**: 200 MB 可用空间
- **网络**: 激活时需要互联网连接（可选）

### 依赖版本

- **Electron**: 23.0.0
- **Node.js**: 16.0.0+
- **npm**: 8.0.0+
- **sql.js**: 1.8.0

### 构建配置

```json
{
  "appId": "com.yourdomain.specialeducation",
  "productName": "特殊教育多模态干预系统",
  "win": {
    "target": ["nsis"],
    "icon": "images/icon.ico"
  },
  "nsis": {
    "oneClick": false,
    "allowToChangeInstallationDirectory": true,
    "createDesktopShortcut": true
  }
}
```

---

## 安装和激活

### 安装步骤

1. 下载安装程序：`特殊教育多模态干预系统 1.0.0.exe`
2. 双击运行安装程序
3. 选择安装路径（默认 Program Files）
4. 等待安装完成
5. 首次启动时显示激活页面

### 激活过程

1. **获取机器码**
   - 点击"获取机器码"按钮
   - 复制显示的 64 位十六进制码

2. **获取激活码**
   - 使用激活码生成工具（离线）
   - 输入机器码和密钥
   - 生成激活码

3. **输入激活码**
   - 粘贴激活码到激活页面
   - 点击激活按钮
   - 应用进行加密保存

4. **进入应用**
   - 激活成功后自动进入主界面
   - 激活信息存储在本地（加密）

---

## 已知限制和注意事项

### 虚拟机运行

⚠️ **重要**: 生产版本在虚拟机中运行时会生成警告日志

```
日志内容：Application is running in a virtual machine
指标：系统会记录检测到的虚拟化标志
建议：不建议在虚拟机中使用生产版本
```

### 密钥管理

⚠️ **关键**: 生产环境必须配置密钥环境变量

```
必需变量：
  - ACTIVATION_SECRET_KEY (≥32 字符)
  - ACTIVATION_ENCRYPTION_KEY (32 字节十六进制)
  - ACTIVATION_ENCRYPTION_IV (16 字节十六进制)

不配置会：使用默认值（仅适合演示）
```

### 升级兼容性

✅ **完全兼容**: 从 0.x 或之前版本升级

```
自动处理：
  - 旧激活信息自动加密转换
  - 旧 MD5 机器码自动兼容
  - 使用统计数据完全保留

用户无需：
  - 重新激活
  - 重新配置
  - 导出/导入数据
```

---

## 单元测试覆盖

✅ **99/99 测试通过** (100% 通过率)

### 测试套件

- ✅ 配置管理 (7 个测试)
- ✅ 产品名称管理 (12 个测试)
- ✅ 权限管理 (2 个测试)
- ✅ 缓存管理 (18 个测试)
- ✅ 使用统计 (28 个测试)
- ✅ 日志管理 (32 个测试)

### 测试覆盖项

```
功能测试：
  ✅ 激活码验证
  ✅ 机器码生成（MD5 和 SHA-256）
  ✅ 激活信息加解密
  ✅ 虚拟机检测
  ✅ 产品配置管理
  ✅ 使用统计记录
  ✅ IPC 通信
  ✅ 缓存管理

安全测试：
  ✅ 加密密钥验证
  ✅ 数据完整性检查
  ✅ 权限管理
  ✅ 日志安全记录
```

---

## 部署检查清单

在部署到生产环境前，请确认：

### 环境配置
- [ ] Node.js ≥ 16.0.0
- [ ] npm ≥ 8.0.0
- [ ] node_modules 已安装

### 安全配置
- [ ] ACTIVATION_SECRET_KEY 已设置
- [ ] ACTIVATION_ENCRYPTION_KEY 已生成
- [ ] ACTIVATION_ENCRYPTION_IV 已生成
- [ ] NODE_ENV 设置为 production
- [ ] .env 文件已添加到 .gitignore
- [ ] 所有密钥从版本控制中排除

### 代码质量
- [ ] 所有 99 个单元测试通过
- [ ] npm run build 成功完成
- [ ] 安装程序在测试环境验证通过
- [ ] 所有安全修复已集成

### 文档
- [ ] 已阅读 DEPLOYMENT_GUIDE.md
- [ ] 已阅读此发布说明
- [ ] 已准备激活码生成工具更新

---

## 重大变更

### 不兼容变更

❌ **激活码生成工具需要更新**
- 旧工具使用 MD5 算法
- 新版本支持 MD5（向后兼容）和 SHA-256（推荐）
- 建议更新工具使用 SHA-256 算法

### 数据格式变更

❌ **激活信息存储格式变更**
- 旧格式：明文 JSON（{machineCode, activationCode, ...}）
- 新格式：加密 JSON ({encrypted: "base64..."})
- 自动迁移：应用启动时自动转换

### API 变更

✅ **没有 API 变更** - IPC 接口保持不变

---

## 反馈和支持

### 报告问题

如遇到问题，请检查：

1. **应用日志**
   ```
   位置: %APPDATA%\特殊教育多模态干预系统\logs\
   ```

2. **激活信息**
   ```
   位置: %APPDATA%\特殊教育多模态干预系统\data\activation.json
   状态: 应为加密格式 {encrypted: "..."}
   ```

3. **系统环境变量**
   ```
   确认: ACTIVATION_SECRET_KEY 等密钥已设置
   ```

### 常见问题

**Q: 升级后激活码无效？**  
A: 旧密钥生成的激活码继续有效。确认密钥设置正确。

**Q: 虚拟机中无法运行？**  
A: 生产版本在虚拟机中生成警告。可在 ENABLE_VM_DETECTION=false 时允许运行。

**Q: 密钥丢失怎么办？**  
A: 需要重新生成密钥并更新所有用户的激活码。建议定期备份。

---

## 许可和版权

**应用**: 特殊教育多模态干预系统  
**版本**: 1.0.0  
**作者**: HangZhou ShineCan Technology Co., Ltd  
**许可**: MIT  
**版权**: © 2013-2024

---

## 更新日志

### 版本 1.0.0 (2024-12-16)

**首次生产发布**

- 🔒 安全增强：4 个 P0 级别漏洞修复
- ✨ 新增虚拟机检测和密钥管理
- 🎨 UI 优化和功能完善
- ✅ 99/99 单元测试通过
- 📚 完整的部署文档

---

## 下一步

1. **部署生产版本**
   ```bash
   npm run build
   # 生成: dist/特殊教育多模态干预系统 1.0.0.exe
   ```

2. **在测试环境验证**
   - 安装应用
   - 激活应用
   - 测试所有功能

3. **发布给最终用户**
   - 准备发布说明
   - 安排技术支持
   - 监控反馈

4. **持续维护**
   - 监控应用日志
   - 收集用户反馈
   - 计划下一个版本改进

---

**感谢使用特殊教育多模态干预系统！**
